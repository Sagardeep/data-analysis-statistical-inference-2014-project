Data Analysis Project
=====================

Project preparation with ProjectTemplate [[1](#projecttemplate)].
``` {r knitr_options, echo=FALSE, warning=FALSE}
require(knitr)
opts_knit$set(root.dir="..")
opts_chunk$set(fig.path="../graphs/analysis-")
```

```{r load_project, echo=FALSE, warning=FALSE}
require(ProjectTemplate)
reload.project()
```

Introduction
------------

The research focus is on the relationship between the degree obtained by US
residents and their family income in constant dollars.

Access to education and its funding is the subject of many discussions on social
mobility and redistribution of income. The research explores historical data
to verify one of main topic of these discussions: if more education is related to
an higher personal and family income.

Data
----

### General Social Survey (GSS)

The research uses data from the General Social Survey (GSS) which has been monitoring
change in American society since 1972. Until 1994, it was conducted almost annually.
Since 1994, the GSS has been conducted in even numbered years.

The vast majority of GSS data is obtained in face-to-face interviews, computer-assisted
personal interviewing (since 2002), and by telephone.

The interviewees are individuals English and Spanish speaking persons 18 years of
age or older, living in the United States. They are selected from metropolitan and
rural areas. Multiple level of stratification for region, race, age, income and
sex was employed to garantee a random sample.

The target sample size is of 1500 cases every year until 1994. Since 1994 the GSS
has been administered to two samples in even-numbered years, each with a target
sample size of 1500.

For more information please refer to GSS FAQ [[2](#gssfaq)].

### Research type

Since the data come from a survey and not from an experiment, the research can
be classified as **observational** and it can establish only a relation between
the variables studied and not a causal link.

However the research's findings could be **generalized** to the entire United States
population because the survey uses random sampling techniques.

### Variables

The research uses two variables chosen from those collected by GSS survey:

* **Highest Degree**: it is a ordinal categorical variable collected with the question
  "Did you ever get a high school diploma or a GED certificate?"; its levels are
  Lt High School, High School, Junior College, Bachelor, Graduate
* **Family Income in Constant Dollars**: it is a continuous numerical variable
  and it measure the inflation-adjusted family income

Exploratory data analysis
-------------------------

### Data preparation

Before exploring the data we create a dataset with the two variables of interest
plus the year, then we filter out the cases with missing values, and finally we
give a clearer description to the columns.
```{r research_data, warning=FALSE}
research_data = gss[,c(2,12,27)]
research_data = research_data[complete.cases(research_data),]
colnames(research_data) <- c("Year","Highest.Degree","Family.Income.Constant.USD")
```

### Distribution by year and missing values

The cases in the original data are 57061, evenly distributed by year until 1993,
and then distributed every two years since 1994.
```{r nrow_gss, warning=FALSE}
nrow(gss)
table(gss$year)
```

The cases in the research data are 50393, with a distribution similar to that
of the original data.
```{r nrow_research_data, warning=FALSE}
nrow(research_data)
table(research_data$Year)
```

We can conclude that filtering out the missing values has not changed the distribution
of the sample data.

### Summary statistics for Highest Degree

Highest Degree is a categorical variable. We summarize it with a frequency table
and a barplot.
```{r highest_degree_summary, warning=FALSE}
prop.table(table(research_data$Highest.Degree))
par(mar = c(8, 4, 4, 2) + 0.1)
barplot(table(research_data$Highest.Degree), las=2, main="Highest Degree")
```

We can see that High School is prevalent with more than 70% of the cases,
while the remaining 30% has some kind of college degree.

### Summary statistics for Family Income in constant USD

Family Income is a continuous numerical variable. We summarize it with mean,
range and quartiles, and with a histogram.
```{r family_income_summary, warning=FALSE}
summary(research_data$Family.Income.Constant.USD)
par(mar = c(5, 4, 4, 2) + 0.1)
hist(research_data$Family.Income.Constant.USD, main="Family Income in constant USD", xlab="USD")
```

We can see that the distribution is right skewed and unimodal. 50% of
the cases are in the 18,500-59,500 USD (constant dollar) range.

### Relationship among Family Income and Highest Degree

Finally, we explore the relationship among Family Income and Highest Degree.

```{r income_degree_rel, warning=FALSE}
par(mar = c(8, 4, 4, 2) + 0.1)
boxplot(research_data$Family.Income.Constant.USD ~ research_data$Highest.Degree, las= 2, main="Family Income in constant USD by Degree")
```

We can see that exists a positive association between Family Income and Higher Degree.
But the wider interquantile range in the college degree categories and the higher
number of outliers in the high school degree ones, means that such a relationship is
not strong and that Family Income could be associated with other variables.

Inference
---------

Ho = the mean income is equal for all Higher Degree levels
Ha = the mean income is different for at least two Higher Degree levels

Condition

* indipendence: the data are random samples from less than 10% of the population
  and so they could be considered indipendent
* approximately normal:

```{r qqplot_degree, warning=FALSE, fig.width=11, fig.height=2.5}
par(mfrow = c(1,5))
degrees = c("Lt High School","High School","Junior College","Bachelor","Graduate")
for (i in 1:5) {
  qqnorm(research_data[research_data$Highest.Degree == degrees[i],]$Family.Income.Constant.USD, main=degrees[i])
}
```

* constant variance:

Anova and pairwise tests

```{r anova, warning=FALSE}
anova(lm(Family.Income.Constant.USD ~ Highest.Degree, data=research_data))
```

#### Question
* State hypotheses
* Check conditions
* State the method(s) to be used and why and how
* Perform inference
* Interpret results
* If applicable, state whether results from various methods agree

It is your responsibility to figure out the appropriate methodology. What techniques you use to conduct inference will depend on the type of data you're using, and your sample size. All of you should conduct at least a hypothesis test, and report the associated p-value and the conclusion. Those of you comparing two means, two medians, or two proportions should also calculate a confidence interval for the parameter of interest. Those of you working with categorical variables with more than two levels will need to use methods like ANOVA and chi-square testing for which there is no associated confidence interval, and that's ok. If your data fails some conditions and you can't use a theoretical method, then you should use an appropriate simulation based method. 

* If you can use both theoretical and simulation based methods, then choose one and stick with it. You don't have to do both. However if you can't use both, then you need to decide which is appropriate.
* If you can do both a hypothesis test and a confidence interval, do both, and comment on agreement of the results from the two methods. However if your variables do not lend themselves to a confidence interval, that's ok.
* It's essential to make sure the method you're using is appropriate for the dataset and the research question you're working with.

#### Evaluation
Are the hypothesis is stated clearly and matches the research question?

Are the conditions checked in context of the data (not just a generic bullet point list of the conditions, but reasoning through them for the given dataset)?

Are the appropriate method(s) the writer will be using stated? Did the author provide a discussion of why they chose these methods, and described how they work? Note that in this part the author should display a thorough and conceptual understanding of how the methodology works, however the write-up does not need to be as detailed as if they were teaching the method to someone with no background in statistics.

Was the correct code used and output provided for all required techniques? See below for which situation requires which technique:

* One numerical and one categorical variable (with only 2 levels): hypothesis test + confidence interval
 * parameter of interest = difference between two means (theoretical or simulation)
 * parameter of interest = difference between two medians (simulation only)
* One numerical and one categorical variable (with more than 2 levels): hypothesis test only
 * compare means across several groups
 * no defined parameter of interest, ANOVA and pairwise tests (theoretical only)
* Two categorical variables (each with only 2 levels): hypothesis test + confidence interval
 * parameter of interest = difference between two proportions (theoretical if success-failure condition met, simulation if not)
* Two categorical variables (either one or both with more than 2 levels): hypothesis test only
 * compare proportions across several groups
 * no defined parameter of interest, Chi-square test only (theoretical if expected sample size condition met, simulation if not)

Are correct interpretations and conclusions for all output provided? Note that this portion should be evaluated based on criteria stated earlier about which technique is required when). This includes some or all of

* conclusions of hypothesis tests,
* interpretations of p-values as conditional probabilities, and
* interpretations of confidence intervals

depending on the methods used. All interpretations must be in context of the data and the research question.

Is whether or not results from hypothesis test and confidence interval agree stated? Or, if doing ANOVA or chi-square testing, did the author state that no other methods were applicable and hence there's nothing to compare?

Conclusion
----------

#### Question
Write a brief summary of your findings without repeating your statements from earlier. Include a discussion of what you have learned about your research question and the data you collected, and include ideas for possible future research.

#### Evaluation
Is there a brief summary of findings that does not repeat previous statements?

Is a discussion of what was learned about the research question provided?

Are ideas for possible future research and/or discussion of additional synthesis or possible shortcomings of study provided?

References
----------

### Data reference

General Social Survey Cumulative File, 1972-2012 Coursera Extract.
Modified for Data Analysis and Statistical Inference course (Duke University).

R dataset could be downloaded at http://bit.ly/dasi_gss_data.

Original data:

Smith, Tom W., Michael Hout, and Peter V. Marsden. General Social Survey, 1972-2012
[Cumulative File]. ICPSR34802-v1. Storrs, CT: Roper Center for Public Opinion Research,
University of Connecticut /Ann Arbor, MI: Inter-university Consortium for Political
and Social Research [distributors], 2013-09-11. doi:10.3886/ICPSR34802.v1

Persistent URL: http://doi.org/10.3886/ICPSR34802.v1

### Other references

1. <a name="projecttemplate"/>ProjectTemplate, a system for automating the thoughtless
   parts of a data analysis project. URL: <http://projecttemplate.net/>.
2. <a name="gssfaq"/>General Social Survey (GSS) FAQ.
   URL: <http://publicdata.norc.org:41000/gssbeta/faqs.html>.
   Accessed 03/30/2014

Appendix
--------

Example of the data used in the research.

```{r research_data_head, warning=FALSE}
head(research_data, n=40L)
```